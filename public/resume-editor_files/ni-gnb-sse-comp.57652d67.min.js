(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{114:function(e,t,n){"use strict";n.r(t);var r=n(56),o=n(0),i="NewSSEConnection",c="SSEConnectionError",a=n(62);function u(e){return u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},u(e)}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,p(r.key),r)}}function l(e,t,n){return t&&s(e.prototype,t),n&&s(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function f(e,t,n){return(t=p(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function p(e){var t=function(e,t){if("object"!==u(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==u(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===u(t)?t:String(t)}var v=self.EventSource||a.NativeEventSource||a.EventSourcePolyfill,b=l((function e(t,n){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),f(this,"createEventSource",(function(){r.eventSource=new v(r.url,r.configuration),r.eventSource.addEventListener("open",(function(e){}))})),f(this,"addEventListener",(function(e,t){r.eventSource.addEventListener(e,t),e in r.listeners||(r.listeners[e]=[]),r.listeners[e].push(t)})),f(this,"removeEventListener",(function(e,t){if(r.eventSource.removeEventListener(e,t),e in r.listeners)for(var n=r.listeners[e],o=0,i=n.length;o<i;o++)if(n[o]===t)return void n.splice(o,1)})),f(this,"closeSSEConnection",(function(e){r.eventSource.close()})),f(this,"closeConnectionOnlyNotMessagePort",(function(e){r.closeSSEConnection(e)})),this.url=t,this.configuration=n,this.listeners={},this.eventSource=null,this.createEventSource()}));function y(e){return y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},y(e)}function d(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,h(r.key),r)}}function m(e,t,n){return(t=h(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function h(e){var t=function(e,t){if("object"!==y(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==y(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===y(t)?t:String(t)}var S=function(){function e(t,n,r){var o=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),m(this,"createSharedWorker",(function(e){o.sharedWorker=new SharedWorker(e),o.sharedWorker.port.onmessage=function(e){o.listeners[e.data.event]&&o.listeners[e.data.event][0](e.data)},o.sharedWorker.onerror=function(e){o.port&&o.port.close(),o.closeSSEConnection("Shared worker is closed due to error.")},window.addEventListener("unload",(function(){o.sharedWorker.port.postMessage({eventType:"tabClose"}),o.port&&o.port.close()}))})),m(this,"closeSSEConnection",(function(e){o.sharedWorker.port.postMessage({eventType:"close",message:e})})),m(this,"closeConnectionOnlyNotMessagePort",(function(e){o.sharedWorker.port.postMessage({eventType:"closeConnectionOnly",message:e})})),this.url=t,this.configuration=n,this.listeners={},this.sharedWorker=null,this.createSharedWorker(r)}var t,n,r;return t=e,(n=[{key:"addEventListener",value:function(e,t){this.sharedWorker.port.postMessage({eventSourceURL:this.url,configuration:this.configuration,eventType:e}),e in this.listeners||(this.listeners[e]=[]),this.listeners[e].push(t)}},{key:"removeEventListener",value:function(e,t){if(e in this.listeners)for(var n=this.listeners[e],r=0,o=n.length;r<o;r++)if(n[r]===t)return void n.splice(r,1)}}])&&d(t.prototype,n),r&&d(t,r),Object.defineProperty(t,"prototype",{writable:!1}),e}(),g=self.EventSource||a.NativeEventSource||a.EventSourcePolyfill,w=function(e,t,n){return window.SharedWorker?new S(e,{withCredentials:n},t):g?new b(e,{withCredentials:n}):void 0},O="",j="",E=!1,C={},P=0,N=5e3,L=!1,k=0,R=0,D=function(e,t,n){var r=w(e,t,n);return I(r),r},T=function(){clearTimeout(P),L=!1},I=function(e){e.addEventListener("pageAction",(function(e){"refresh"===e.data&&location.reload(!0)})),e.addEventListener("error",(function(t){var n="Connection is closed by the server";k<R?(e.closeSSEConnection(n),L||(L=!0,P=setTimeout((function(){T();var e=D(O,j,E);for(var t in C)e.addEventListener(t,C[t])}),N),k++)):k===R&&(n="Last try to create connection is over.",e.closeConnectionOnlyNotMessagePort(n),k++),window.dispatchEvent(new Event(c))})),e.addEventListener("open",(function(e){window.NewSSEConnection=!0,window.dispatchEvent(new Event(i))}))},J=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/sharedWorker.js",n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];O=e,j=t,E=n,R=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,N=arguments.length>4&&void 0!==arguments[4]?arguments[4]:5e3;var r=D(e,t,n);return r.closeConnection=function(){r.closeSSEConnection("Connection is closed by the user")},r.addEventListenerSse=function(e,t){r.addEventListener(e,t),e in C||(C[e]=t)},r},_=null,W=!0,A=10,M=5e3,U=n(5),F=n(45);function q(e){return q="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},q(e)}function V(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function K(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?V(Object(n),!0).forEach((function(t){x(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):V(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function x(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==q(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==q(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===q(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var B="showOnGnb",G="noti_count",Y="noti_description",$=[G,"total_count",Y],z=[].concat($,["freq",B]),H=function(e,t){e.addEventListenerSse(U.g.RECO_JOBS,(function(e){if(e.data)try{var n=(r=JSON.parse(e.data),o=r,i={recoJobs:{}},$.forEach((function(e){var t=o[e];e!==Y&&(t=parseInt(t)||0),i.recoJobs[e]=t,e===G&&(i.recoJobs.original_noti_count=i.recoJobs.noti_count),delete o[e]})),{recoJobsConfig:o,recoJobsData:i});t(n,!0)}catch(e){Object(F.a)(e)}var r,o,i}))},Q=n(39),X=n(6),Z=n(11),ee=n(42),te=n(10),ne=n(13),re=n(1);function oe(e){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},oe(e)}function ie(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ce(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ie(Object(n),!0).forEach((function(t){ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ie(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ae(e,t,n){return(t=function(e){var t=function(e,t){if("object"!==oe(e)||null===e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,t||"default");if("object"!==oe(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"===oe(t)?t:String(t)}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ue=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{},i=r.appStatus,c=void 0===i?{}:i,a=r.rmj,u=void 0===a?{}:a,s=r.profileViews,l=void 0===s?{}:s,f=r.criticalActions,p=void 0===f?{}:f,v=r.FF,b=void 0===v?{}:v,y=r.NL,d=void 0===y?{}:y,m=r.RR,h=void 0===m?{}:m,S=r.recruiterSearch,g=void 0===S?{}:S,w=o.recoJobs,O=void 0===w?{}:w,j=(new Date).getTime(),E={appStatus:c.timestamp||"",rmj:u.timestamp||j,recoJobs:O.timestamp||Object(ne.a)(re.y),profileViews:l.timestamp||j,criticalActions:p.timestamp||"",FF:b.timestamp||"",NL:d.timestamp||"",RR:h.timestamp||"",recruiterSearch:g.timestamp||""},C=ce(ce({},E),{},{jobId:window.location.href.match(/job-listings/)&&window.jobId||null,_:j}),P=Object(te.c)(C),N={headers:{Accept:"application/json","Content-Type":"application/json",SystemId:"naukriIndia",AppId:t}};Object(ee.a)("".concat(e,"?").concat(P),N).then((function(e){var t=function(e,t){var n={status:{}},r={};return null!=e&&e.status&&Object.keys(e.status).length&&Array.isArray(e.order)&&(e.order.forEach((function(t){var o=e.status[t];o&&(n.status[t]=K(K({},o),{},{type:t}),r[t]={},z.forEach((function(e){var i=o[e];[B,Y].includes(e)||(i=parseInt(i)||0),r[t][e]=i,e===G&&(r[t].original_noti_count=r[t].noti_count),delete n.status[t][e]})))})),Object.keys(t).forEach((function(e){r[e]||(r[e]={}),r[e].timestamp=t[e]})),n.newCount=parseInt(e.newCount)||0,n.totalCount=parseInt(e.totalCount)||0,n.domain=e.domain||""),{otherNotifConfig:n,otherNotifData:r}}(e,E);n(ce(ce({otherNotifData:t.otherNotifData},Object(Z.a)("otherNotifConfig",t.otherNotifConfig,36e5)),{},{recoJobsConfig:void 0,recoJobsData:void 0,refetchNotificationData:!1}),!0)})).catch((function(e){console.log(e)}))};function se(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,o,i,c,a=[],u=!0,s=!1;try{if(i=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;u=!1}else for(;!(u=(r=i.call(n)).done)&&(a.push(r.value),a.length!==t);u=!0);}catch(e){s=!0,o=e}finally{try{if(!u&&null!=n.return&&(c=n.return(),Object(c)!==c))return}finally{if(s)throw o}}return a}}(e,t)||function(e,t){if(!e)return;if("string"==typeof e)return le(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return le(e,t)}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function le(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var fe=function(e){var t=e.config,n=e.appId,r=e.envType,i=se(Object(o.useState)(!0),2),c=i[0],a=i[1],u=Object(X.b)(),s=u.appState,l=u.updateAppState,f=u.resyncFromStorage,p=s.otherNotifConfig,v=s.otherNotifData,b=s.recoJobsData,y=s.refetchNotificationData,d=s.userId,m=function(){a(!document.hidden)};return Object(o.useEffect)((function(){var e=function(e){var t=e.SERVICE_URL,n=e.WORKER_URL;return _||(_=J(t,n,W,A,M))}(t);H(e,l)}),[]),Object(Q.a)((function(){return document.addEventListener("visibilitychange",m),function(){document.removeEventListener("visibilitychange",m)}}),[]),Object(Q.a)((function(){if(c)if(y||Object(Z.d)(p)){if(Object(Z.e)(r,!0,d))return;ue(t.NOTIFY_URL,n,l,v,b)}else f(["otherNotifConfig","otherNotifData","recoJobsConfig","recoJobsData"])}),[c,y]),null};fe.propTypes={appId:r.string,config:Object(r.shape)({SERVICE_URL:r.string.isRequired,WORKER_URL:r.string.isRequired}).isRequired,envType:r.string.isRequired};t.default=fe}}]);